From ec366e9ad70815d96adce0d936bac34c1646e061 Mon Sep 17 00:00:00 2001
From: Nobuhiro Iwamatsu <iwamatsu@debian.org>
Date: Sat, 5 Jan 2019 06:40:57 +0900
Subject: [PATCH 1/3] Move function of endian from Crossbuild to build

Signed-off-by: Nobuhiro Iwamatsu <iwamatsu@debian.org>
---
 lib/mruby/build.rb | 44 ++++++++++++++++++++++----------------------
 1 file changed, 22 insertions(+), 22 deletions(-)

diff --git a/lib/mruby/build.rb b/lib/mruby/build.rb
index e2d9fc41..64a9269a 100644
--- a/lib/mruby/build.rb
+++ b/lib/mruby/build.rb
@@ -91,6 +91,7 @@ module MRuby
         @enable_bintest = false
         @enable_test = false
         @toolchains = []
+        @endian = nil
 
         MRuby.targets[@name] = self
       end
@@ -118,6 +119,27 @@ module MRuby
       @enable_debug = true
     end
 
+    def big_endian
+      if @endian
+        puts "Endian has already specified as #{@endian}."
+        return
+      end
+      @endian = :big
+      @mrbc.compile_options += ' -E'
+      compilers.each do |c|
+        c.defines += %w(MRB_ENDIAN_BIG)
+      end
+    end
+
+    def little_endian
+      if @endian
+        puts "Endian has already specified as #{@endian}."
+        return
+      end
+      @endian = :little
+      @mrbc.compile_options += ' -e'
+    end
+
     def disable_cxx_exception
       if @cxx_exception_enabled or @cxx_abi_enabled
         raise "cxx_exception already enabled"
@@ -357,7 +379,6 @@ EOS
     attr_accessor :host_target, :build_target
 
     def initialize(name, build_dir=nil, &block)
-      @endian = nil
       @test_runner = Command::CrossTestRunner.new(self)
       super
     end
@@ -376,26 +397,5 @@ EOS
         @test_runner.run(mrbtest)
       end
     end
-
-    def big_endian
-      if @endian
-        puts "Endian has already specified as #{@endian}."
-        return
-      end
-      @endian = :big
-      @mrbc.compile_options += ' -E'
-      compilers.each do |c|
-        c.defines += %w(MRB_ENDIAN_BIG)
-      end
-    end
-
-    def little_endian
-      if @endian
-        puts "Endian has already specified as #{@endian}."
-        return
-      end
-      @endian = :little
-      @mrbc.compile_options += ' -e'
-    end
   end # CrossBuild
 end # MRuby
-- 
2.20.1

